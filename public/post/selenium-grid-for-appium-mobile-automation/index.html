<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.47d1b5bf16c505af7810.css">code[class*=language-],pre[class*=language-]{color:#fff;background:none;text-shadow:0 -.1em .2em #000;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}:not(pre)>code[class*=language-],pre[class*=language-]{background:#4d4033}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border:.3em solid #7a6652;border-radius:.5em;box-shadow:inset 1px 1px .5em #000}:not(pre)>code[class*=language-]{padding:.15em .2em .05em;border-radius:.3em;border:.13em solid #7a6652;box-shadow:inset 1px 1px .3em -.1em #000;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#998066}.namespace,.token.punctuation{opacity:.7}.token.boolean,.token.constant,.token.number,.token.property,.token.symbol,.token.tag{color:#d1949e}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#bde052}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#f5b83d}.token.atrule,.token.attr-value,.token.keyword{color:#d1949e}.token.important,.token.regex{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.deleted{color:red}</style><meta name="generator" content="Gatsby 2.17.15"/><title data-react-helmet="true"></title><style data-styled="ikafup foMuCR gLpOGS" data-styled-version="4.4.1">
/* sc-component-id: styles__MainContainer-t2oe9l-0 */
.ikafup{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;margin-right:auto;margin-left:auto;} @media (min-width:62em){.ikafup{margin:auto;max-width:800px;}}
/* sc-component-id: styles__PostContainer-t2oe9l-1 */
.foMuCR{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:20px;border-bottom:1px solid #2f363d;}
/* sc-component-id: styles__PostTitle-t2oe9l-2 */
.gLpOGS{margin-bottom:10px;} .gLpOGS a{-webkit-text-decoration:none;text-decoration:none;color:#fff;} .gLpOGS a:hover{-webkit-text-decoration:none;text-decoration:none;color:tomato;}</style><link as="script" rel="preload" href="/styles-7d80867f00087d927dc3.js"/><link as="script" rel="preload" href="/component---src-templates-post-js-fc6b7d673d21db92d6fd.js"/><link as="script" rel="preload" href="/commons-0e8c48515ea2cb7bd8b7.js"/><link as="script" rel="preload" href="/app-897c9dd6c4ce5585a002.js"/><link as="script" rel="preload" href="/webpack-runtime-d4005e6e7a9e7cc9bfbe.js"/><link as="fetch" rel="preload" href="/page-data/post/selenium-grid-for-appium-mobile-automation/page-data.json" crossorigin="anonymous"/></head><body><noscript id="gatsby-noscript">This app works best with JavaScript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper"><div class="styles__MainContainer-t2oe9l-0 ikafup"><div class="styles__PostContainer-t2oe9l-1 foMuCR"><h2 class="styles__PostTitle-t2oe9l-2 gLpOGS">Selenium Grid for Appium mobile automation</h2><p>Often we wanted to perform mobile execution in parallel. The best way of performing the parallel execution is through selenium grid. I’ve faced few issues while setting up the grid for appium. I’ll share my learnings about setting up the grid for appium mobile automation.</p><h2 id="pre-requisites">Pre-requisites</h2><ul><li><a href="http://selenium-release.storage.googleapis.com/2.53/selenium-server-standalone-2.53.0.jar">Download selenium standalone server jar file</a> - At the time of writing, the version of latest selenium is 2.53.</li><li><a href="http://appium.io/">Appium</a> - The version that I was using is 1.4.16 and installed as Node npm package. I recommend to you also use npm package.</li><li>Atleast two android devices for this experiment.</li></ul><h2 id="setup-the-selenium-grid">Setup the selenium grid</h2><p>Place the downloaded selenium standalone server jar in some directory. In my case I’ve placed in /Users/{username}/Tools/selenium.</p><p>Open your terminal and navigate to the directory to where you placed the jar file and execute the following command:</p><pre><code class="language-bash">java -jar selenium-server-standalone-2.53.0.jar -role hub
</code></pre><p>This will start the selenium grid server in your local ip with the default port of <strong>4444</strong>. After you see this message <strong>Selenium Grid hub is up and running</strong>, open your browser and hit the following url: <a href="http://%7Byour">http://{your</a> ip}:4444/grid/console and you should be able to see the following in your browser:</p><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:420px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:11.328125%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsSAAALEgHS3X78AAAAZklEQVQI12NYsmz1/8yCjv+JeV1Q3Pk/Lrv9f2Ra8//IdOJwdEbL/+DE+v+NPYv/M2zbfuT/vMVb/m/YeuD/6g17/q/euOf/ouVb/0+etfL/1Dmr/0+dvYowBqqbNHPF/517j/8HAH9haVPeizTCAAAAAElFTkSuQmCC&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="Selenium Grid console page" title="Selenium Grid console page" src="/static/64daf953d08b714a4c307d7c4124e9e1/635b1/Screen-Shot-2016-05-15-at-4.18.35-PM-1024x116.png" srcSet="/static/64daf953d08b714a4c307d7c4124e9e1/759d4/Screen-Shot-2016-05-15-at-4.18.35-PM-1024x116.png 105w,/static/64daf953d08b714a4c307d7c4124e9e1/6a467/Screen-Shot-2016-05-15-at-4.18.35-PM-1024x116.png 210w,/static/64daf953d08b714a4c307d7c4124e9e1/635b1/Screen-Shot-2016-05-15-at-4.18.35-PM-1024x116.png 420w,/static/64daf953d08b714a4c307d7c4124e9e1/b2a12/Screen-Shot-2016-05-15-at-4.18.35-PM-1024x116.png 630w,/static/64daf953d08b714a4c307d7c4124e9e1/04a72/Screen-Shot-2016-05-15-at-4.18.35-PM-1024x116.png 840w,/static/64daf953d08b714a4c307d7c4124e9e1/3b243/Screen-Shot-2016-05-15-at-4.18.35-PM-1024x116.png 1024w" sizes="(max-width: 420px) 100vw, 420px" loading="lazy"/>
    </span></p><p>Congratulations!!! You started your grid successfully. Let’s setup the nodes for our mobile devices.</p><h2 id="setup-the-appium-nodes">Setup the Appium nodes</h2><p>I’ve two devices with me now, samsung S4 and samsung S5. I’m going to setup grid nodes for these two devices.</p><p>As per the documentation of appium <a href="http://appium.io/slate/en/master/?ruby#selenium-grid">here</a>, we need a node config json file to hook our appium node to our selenium grid hub. Let’s prepare our 1st node config json and I’m calling that as <strong>node_s4.json</strong>:</p><pre><code class="language-javascript">{
  &quot;capabilities&quot;: [{
    &quot;applicationName&quot;: &quot;Samsung S4&quot;,
    &quot;browserName&quot;: &quot;Samsung S4&quot;,
    &quot;platformName&quot;: &quot;ANDROID&quot;,
    &quot;maxInstances&quot;: 1
  }],
  &quot;configuration&quot;: {
    &quot;cleanUpCycle&quot;: 2000,
    &quot;timeout&quot;: 30000,
    &quot;proxy&quot;: &quot;org.openqa.grid.selenium.proxy.DefaultRemoteProxy&quot;,
    &quot;host&quot;: &quot;127.0.0.1&quot;,
    &quot;port&quot;: 4723,
    &quot;maxSession&quot;: 1,
    &quot;register&quot;: true,
    &quot;registerCycle&quot;: 5000,
    &quot;hubPort&quot;: 4444,
    &quot;hubHost&quot;: &quot;192.168.0.198&quot;
  }
}
</code></pre><p>Here <strong>applicationName</strong> is mandatory since the grid identifies to which appium node the job should b e routed. Also, make sure you change the <strong>hubHost</strong> to your ip address.</p><p>Now let’s start our appium node with this node config. In your terminal, start your appium like this:</p><pre><code class="language-bash">appium --nodeconfig /Users/{username}/Tools/selenium/node_s4.json -p 4723 -bp 4724 -U {s4 device id}
</code></pre><p>This will start the appium server on the port 4723 and the bootstrap port 4724 (remember, the bootstrap port is mandatory for android devices) and with the device id of your device which you can get from <strong>adb devices</strong>.</p><p>Now refresh your grid console in your browser and you should see this:</p><p><img src="./Screen-Shot-2016-05-15-at-5.02.03-PM-1024x210.png" alt="Grid console with S4 device"/></p><p>Do the same for another device. In my case, the node json for samsung S5 device will look like:</p><pre><code class="language-javascript">{
  &quot;capabilities&quot;: [{
    &quot;applicationName&quot;: &quot;Samsung S5&quot;,
    &quot;browserName&quot;: &quot;Samsung S5&quot;,
    &quot;platformName&quot;: &quot;ANDROID&quot;,
    &quot;maxInstances&quot;: 1
  }],
  &quot;configuration&quot;: {
    &quot;cleanUpCycle&quot;: 2000,
    &quot;timeout&quot;: 30000,
    &quot;proxy&quot;: &quot;org.openqa.grid.selenium.proxy.DefaultRemoteProxy&quot;,
    &quot;host&quot;: &quot;127.0.0.1&quot;,
    &quot;port&quot;: 4730,
    &quot;maxSession&quot;: 1,
    &quot;register&quot;: true,
    &quot;registerCycle&quot;: 5000,
    &quot;hubPort&quot;: 4444,
    &quot;hubHost&quot;: &quot;&lt;&lt;your ip&gt;&gt;&quot;
  }
}
</code></pre><p>Changed the applicationName, browserName and port of appium node, and saved the file as <strong>node_s5.json</strong>. Now start your 2nd appium node in another terminal like this:</p><pre><code class="language-bash">appium --nodeconfig /Users/{username}/Tools/selenium/node_s5.json -p 4730 -bp 4731 -U {s5 device id}
</code></pre><p>Refresh your browser and you should see this in your grid console page:</p><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:420px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:20.703125%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsSAAALEgHS3X78AAAA+0lEQVQY022K20vCcACF9wd28zG7MLGMyGVBFzUrpTZjVGARRVKPPQhJhRD9Ky6jh22KbnQzqOn62m/US/Rw+DjnfNLJcRl5Jk88pRNLFpGTGtFEgeHxDJGJLJHJLIPRVQZGV0KOBJuI+AV/naGxNDGliLR3WEbbP2V9+4DcVokN7Yi5JZW4skkiVUCezaHuCueMteBfTO+gLKssZHSmg39qXnj50NNL50jGY4t6w+KiUqV6c0vDdjEsJ6RI3ezgdj9odp4Dz+a6dsflVQ3DbPPQeuL+xzNMB9t9RTLtF6zmOz3/C6/nh/wbr+/Tdt4w7S6fnh/0frj9530DiPHzbfrQJgIAAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="Grid console with S5" title="Grid console with S5" src="/static/7af7d1ae58928abb8b6ba79b28f198cd/635b1/Screen-Shot-2016-05-15-at-5.14.21-PM-1024x212.png" srcSet="/static/7af7d1ae58928abb8b6ba79b28f198cd/759d4/Screen-Shot-2016-05-15-at-5.14.21-PM-1024x212.png 105w,/static/7af7d1ae58928abb8b6ba79b28f198cd/6a467/Screen-Shot-2016-05-15-at-5.14.21-PM-1024x212.png 210w,/static/7af7d1ae58928abb8b6ba79b28f198cd/635b1/Screen-Shot-2016-05-15-at-5.14.21-PM-1024x212.png 420w,/static/7af7d1ae58928abb8b6ba79b28f198cd/b2a12/Screen-Shot-2016-05-15-at-5.14.21-PM-1024x212.png 630w,/static/7af7d1ae58928abb8b6ba79b28f198cd/04a72/Screen-Shot-2016-05-15-at-5.14.21-PM-1024x212.png 840w,/static/7af7d1ae58928abb8b6ba79b28f198cd/3b243/Screen-Shot-2016-05-15-at-5.14.21-PM-1024x212.png 1024w" sizes="(max-width: 420px) 100vw, 420px" loading="lazy"/>
    </span></p><p>Voila!!! We have two appium nodes connected to our selenium hub.</p><p>In your test now, add the <strong>applicationName</strong> as part of your desired capabilities and point to the grid url instead of appium url. For example, my DesiredCapabilities and driver instantiation would look like:</p><pre><code class="language-java">DesiredCapabilities capabilities = new DesiredCapabilities();
capabilities.setCapability(&quot;platformName&quot;, &quot;Android&quot;);
capabilities.setCapability(&quot;deviceName&quot;, &quot;Android&quot;);
capabilities.setCapability(&quot;applicationName&quot;, &quot;Samsung S4&quot;);
capabilities.setCapability(&quot;app&quot;, &quot;ApiDemos-debug.apk&quot;);
capabilities.setCapability(&quot;appPackage&quot;, &quot;io.appium.android.apis&quot;);
capabilities.setCapability(&quot;appWaitActivity&quot;, &quot;io.appium.android.apis.ApiDemos&quot;);
capabilities.setCapability(&quot;noReset&quot;, true);
driver = new AndroidDriver(new URL(&quot;http://&lt;your ip&gt;:4444/wd/hub/&quot;), capabilities);
</code></pre><p>This will execute tests on Samsung S4 device.</p><h2 id="mistakes-done-and-lessons-learnt">Mistakes done and Lessons learnt</h2><ol><li><strong>applicationName</strong> - I spent more time on solving this issue. I was using <strong>dataProvider</strong> to execute tests in parallel. Even I was having 2 nodes setup, always grid was routing my tests to one node only. This was the haunting problem. Make sure you have this applicationName in your capabilities. The selenium default capability matcher explains about this. Follow this blog for more information: <a href="https://rationaleemotions.wordpress.com/2014/01/19/working-with-a-custom-capability-matcher-in-the-grid/">Rationale Emotions</a>.</li><li><strong>nodeconfig</strong> - Even though you start your appium from the same directory where you placed the node config json files, you should provide the absolute path of the node config json for the parameter <strong>-<!-- -->-nodeconfig</strong> while starting your appium server.</li><li><strong>UDID</strong> - Make sure you start your appium server with the <strong>-<!-- -->U</strong> parameter with your device id in case you have more than one device. The reason is appium always selects the first device in your device list.</li></ol><p>There will be a followup post on how I performed parallel execution using this grid setup. Coming Soon!!!</p></div></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/post/selenium-grid-for-appium-mobile-automation/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-897c9dd6c4ce5585a002.js"],"component---src-templates-post-js":["/component---src-templates-post-js-fc6b7d673d21db92d6fd.js"],"component---src-pages-index-js":["/component---src-pages-index-js-53ce1de268c26107a374.js"]};/*]]>*/</script><script src="/webpack-runtime-d4005e6e7a9e7cc9bfbe.js" async=""></script><script src="/app-897c9dd6c4ce5585a002.js" async=""></script><script src="/commons-0e8c48515ea2cb7bd8b7.js" async=""></script><script src="/component---src-templates-post-js-fc6b7d673d21db92d6fd.js" async=""></script><script src="/styles-7d80867f00087d927dc3.js" async=""></script></body></html>